<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Packify V9 - Master Edition</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap');
        
        :root {
            --primary: #2563eb; --primary-light: #eff6ff;
            --success: #16a34a; --danger: #dc2626; --warn: #d97706;
            --bg: #f8fafc; --surface: #ffffff;
            --text-main: #1e293b; --text-sub: #64748b; --border: #e2e8f0;
            --nav-h: 50px; --safe-b: env(safe-area-inset-bottom, 10px);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Roboto', system-ui, sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background: var(--bg); color: var(--text-main); height: 100dvh; display: flex; flex-direction: column; overflow: hidden; }

        /* TOAST ALERT */
        #toast-container { position: fixed; top: 10px; left: 50%; transform: translateX(-50%); width: 90%; max-width: 400px; z-index: 9999; display: flex; flex-direction: column; gap: 8px; pointer-events: none; }
        .toast { background: #fee2e2; border-left: 4px solid var(--danger); color: #991b1b; padding: 12px 16px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); font-size: 0.85rem; font-weight: 500; display: flex; align-items: flex-start; gap: 8px; animation: slideDown 0.3s ease forwards; pointer-events: auto; }
        @keyframes slideDown { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }

        /* HEADER */
        header { background: var(--surface); padding: 10px 15px; display: flex; align-items: center; gap: 12px; border-bottom: 1px solid var(--border); z-index: 10; flex-shrink: 0; }
        .menu-btn { background: none; border: none; font-size: 1.5rem; color: var(--text-main); cursor: pointer; padding: 4px; }
        .header-info { flex: 1; }
        .app-title { font-size: 1.1rem; font-weight: 700; color: var(--primary); }
        .total-count { font-size: 0.75rem; color: var(--text-sub); font-weight: 500; }
        .search-input { width: 100%; background: var(--bg); border: 1px solid var(--border); padding: 8px 12px; border-radius: 8px; font-size: 0.9rem; outline: none; margin-top: 8px; }

        /* LAZADA-STYLE SIDEBAR */
        .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 40; opacity: 0; pointer-events: none; transition: 0.2s; }
        .overlay.active { opacity: 1; pointer-events: auto; }
        .sidebar { position: fixed; top: 0; left: -280px; width: 260px; height: 100dvh; background: var(--surface); z-index: 50; transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1); display: flex; flex-direction: column; }
        .sidebar.active { left: 0; box-shadow: 4px 0 15px rgba(0,0,0,0.1); }
        .sb-header { padding: 15px; font-weight: 700; font-size: 1.1rem; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; }
        .cat-list { flex: 1; overflow-y: auto; }
        .cat-item { padding: 12px 15px; font-size: 0.9rem; font-weight: 500; color: var(--text-main); border-bottom: 1px solid #f1f5f9; display: flex; justify-content: space-between; align-items: center; cursor: pointer; }
        .cat-item.active { background: var(--primary-light); color: var(--primary); border-left: 3px solid var(--primary); }
        .cat-count { background: var(--bg); color: var(--text-sub); font-size: 0.7rem; padding: 2px 6px; border-radius: 10px; font-weight: 700; }

        /* MAIN CONTENT */
        .main-content { flex: 1; overflow-y: auto; padding: 12px; padding-bottom: calc(var(--nav-h) + var(--safe-b) + 20px); }
        
        /* PROGRESS BAR */
        .progress-container { background: var(--surface); padding: 12px; border-radius: 10px; border: 1px solid var(--border); margin-bottom: 15px; }
        .prog-header { display: flex; justify-content: space-between; font-size: 0.85rem; font-weight: 700; margin-bottom: 6px; }
        .prog-track { height: 8px; background: var(--bg); border-radius: 4px; overflow: hidden; }
        .prog-fill { height: 100%; background: var(--success); width: 0%; transition: 0.3s; }

        /* PRODUCT CARDS */
        .card { background: var(--surface); border-radius: 10px; padding: 12px; margin-bottom: 10px; border: 1px solid var(--border); display: flex; gap: 10px; }
        .card-info { flex: 1; min-width: 0; }
        .item-name { font-size: 0.95rem; font-weight: 700; margin-bottom: 4px; line-height: 1.3; }
        .item-note { font-size: 0.8rem; color: var(--text-sub); line-height: 1.4; margin-bottom: 6px; }
        
        .tags { display: flex; flex-wrap: wrap; gap: 4px; }
        .tag { font-size: 0.65rem; font-weight: 700; padding: 3px 6px; border-radius: 4px; border: 1px solid transparent; }
        .tag-warn { background: #fef2f2; color: var(--danger); border-color: #fca5a5; }
        .tag-safe { background: #f0fdf4; color: var(--success); border-color: #86efac; }
        .tag-digi { background: #eff6ff; color: var(--primary); border-color: #93c5fd; }

        /* BUTTONS */
        .btn { width: 32px; height: 32px; border-radius: 8px; border: none; font-size: 1.2rem; display: flex; align-items: center; justify-content: center; font-weight: bold; cursor: pointer; flex-shrink: 0; }
        .btn-add { background: var(--primary-light); color: var(--primary); }
        .btn-add.added { background: var(--success); color: white; }
        .btn-minus { background: #fef2f2; color: var(--danger); }
        .btn-check { width: 24px; height: 24px; border-radius: 4px; border: 2px solid var(--border); display: flex; align-items: center; justify-content: center; background: white; margin-top: 2px; }
        
        /* DONE STATE */
        .card.done { opacity: 0.6; background: var(--bg); }
        .card.done .btn-check { background: var(--success); border-color: var(--success); }
        .card.done .btn-check::after { content: '‚úì'; color: white; font-size: 14px; font-weight: bold; }
        .card.done .item-name { text-decoration: line-through; }

        /* ULTRA THIN BOTTOM NAV */
        .bottom-nav { position: fixed; bottom: 0; left: 0; right: 0; height: calc(var(--nav-h) + var(--safe-b)); background: var(--surface); display: flex; border-top: 1px solid var(--border); padding-bottom: var(--safe-b); z-index: 20; }
        .nav-item { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; color: var(--text-sub); gap: 2px; }
        .nav-item.active { color: var(--primary); }
        .nav-item svg { width: 20px; height: 20px; stroke-width: 2; fill: none; stroke: currentColor; }
        .nav-label { font-size: 0.65rem; font-weight: 700; }

        .hidden { display: none !important; }
    </style>
</head>
<body>

    <div id="toast-container"></div>
    <div class="overlay" id="overlay" onclick="App.toggleSidebar()"></div>

    <div class="sidebar" id="sidebar">
        <div class="sb-header">
            <span>Danh m·ª•c s·∫£n ph·∫©m</span>
            <span onclick="App.toggleSidebar()" style="cursor:pointer; color: var(--text-sub);">‚úï</span>
        </div>
        <div class="cat-list" id="cat-list"></div>
    </div>

    <header>
        <button class="menu-btn" onclick="App.toggleSidebar()">‚ò∞</button>
        <div class="header-info">
            <div class="app-title">Packify</div>
            <div class="total-count">Kho: <span id="global-count">0</span> items</div>
        </div>
    </header>
    
    <div style="padding: 0 15px; background: var(--surface);">
        <input type="text" class="search-input" id="searchInput" placeholder="T√¨m ki·∫øm nhanh..." onkeyup="App.renderStore()">
    </div>

    <div class="main-content" id="view-store"></div>
    
    <div class="main-content hidden" id="view-bag">
        <div class="progress-container">
            <div class="prog-header">
                <span>Ti·∫øn ƒë·ªô h√†nh l√Ω</span>
                <span id="prog-text">0/0</span>
            </div>
            <div class="prog-track"><div class="prog-fill" id="prog-fill"></div></div>
        </div>
        <div id="bag-list"></div>
    </div>

    <div class="bottom-nav">
        <div class="nav-item active" id="tab-store" onclick="App.switchTab('store')">
            <svg viewBox="0 0 24 24"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path><line x1="3" y1="6" x2="21" y2="6"></line></svg>
            <span class="nav-label">Kho To√†n C·∫ßu</span>
        </div>
        <div class="nav-item" id="tab-bag" onclick="App.switchTab('bag')">
            <svg viewBox="0 0 24 24"><path d="M20 16.2A2 2 0 0 0 22 14.3v-4.6a2 2 0 0 0-2-1.9M4 16.2A2 2 0 0 1 2 14.3v-4.6a2 2 0 0 1 2-1.9"></path><rect x="4" y="2" width="16" height="20" rx="2" ry="2"></rect><line x1="12" y1="2" x2="12" y2="22"></line></svg>
            <span class="nav-label">Vali C·ªßa T√¥i</span>
        </div>
    </div>

    <script>
        // MASTER DATABASE (ƒê√£ gom ƒë·ªß m·ªçi th·ª© cho Du h·ªçc TQ)
        const MASTER_DATA = [
            // SETUP DIGITAL (Ri√™ng cho TQ)
            { id: 'dg1', cat: 'üíª Setup Tr∆∞·ªõc Khi Bay', name: 'C√†i VPN (Clash/V2ray)', note: 'B·∫ÆT BU·ªòC. T·∫£i app v√† mua g√≥i m·∫°ng VN tr∆∞·ªõc. Sang TQ kh√¥ng c√≥ VPN l√† m·∫•t s·∫°ch li√™n l·∫°c.', tags: ['Kh·∫©n c·∫•p', 'Digital'], alert: 'C·∫¢NH B√ÅO: T∆∞·ªùng l·ª≠a TQ ch·∫∑n Google, Facebook, Zalo. Ph·∫£i c√†i VPN ngay khi c√≤n ·ªü VN!' },
            { id: 'dg2', cat: 'üíª Setup Tr∆∞·ªõc Khi Bay', name: 'App Alipay & WeChat', note: 'T·∫£i v√† x√°c minh b·∫±ng H·ªô chi·∫øu. Li√™n k·∫øt th·∫ª Visa/Mastercard n·∫øu c√≥.', tags: ['T√†i ch√≠nh', 'Digital'], alert: 'L∆∞u √Ω: WeChat c·∫ßn ng∆∞·ªùi ƒëang d√πng qu√©t m√£ ƒë·ªÉ x√°c minh t·∫°o t√†i kho·∫£n m·ªõi.' },
            { id: 'dg3', cat: 'üíª Setup Tr∆∞·ªõc Khi Bay', name: 'Backup Script Tampermonkey', note: 'Export code (ƒë√£ config ph√≠m F2) l√™n Drive ƒë·ªÉ c√†i l·∫°i tr√™n m√°y t√≠nh b√™n kia.', tags: ['Code', 'Digital'] },
            { id: 'dg4', cat: 'üíª Setup Tr∆∞·ªõc Khi Bay', name: 'Truy·ªán B√°ch h·ª£p / ABO (Offline)', note: 'T·∫£i ƒë·ªãnh d·∫°ng PDF/Epub v√†o m√°y. C√°ch ly m·∫°ng ho·∫∑c ng·ªìi t√†u xe r·∫•t c·∫ßn.', tags: ['Gi·∫£i tr√≠', 'Digital'] },

            // C√îNG NGH·ªÜ & ƒêI·ªÜN T·ª¨
            { id: 'tc1', cat: 'üîã Thi·∫øt b·ªã C√¥ng ngh·ªá', name: 'S·∫°c d·ª± ph√≤ng Cuktech 25 SE', note: 'Dung l∆∞·ª£ng 25000mAh. Kh√¥ng ƒë∆∞·ª£c b√≥c tem nh√£n th√¥ng s·ªë.', tags: ['X√°ch tay HQ', 'ƒêi·ªán t·ª≠'], alert: 'LU·∫¨T H√ÄNG KH√îNG: Tuy·ªát ƒë·ªëi kh√¥ng ƒë·ªÉ s·∫°c d·ª± ph√≤ng v√†o vali k√Ω g·ª≠i. H·∫£i quan TQ s·∫Ω soi k·ªπ m·∫∑t in th√¥ng s·ªë Wh.' },
            { id: 'tc2', cat: 'üîã Thi·∫øt b·ªã C√¥ng ngh·ªá', name: 'ƒêi·ªán tho·∫°i Vivo iQOO Neo 10', note: 'K√®m c·ªß s·∫°c 120W v√† d√¢y c√°p Type-C.', tags: ['X√°ch tay', 'ƒêi·ªán t·ª≠'] },
            { id: 'tc3', cat: 'üîã Thi·∫øt b·ªã C√¥ng ngh·ªá', name: 'Ph√≠ch c·∫Øm chuy·ªÉn ƒë·ªïi 3 ch·∫•u ch√©o', note: '·ªî c·∫Øm TQ kh√¥ng d√πng ch√¢n tr√≤n. B·∫Øt bu·ªôc mang 1-2 c·ª•c.', tags: ['K√Ω g·ª≠i', 'Thi·∫øt y·∫øu'] },
            
            // GI·∫§Y T·ªú
            { id: 'doc1', cat: 'üìÑ Gi·∫•y t·ªù nh·∫≠p h·ªçc', name: 'H·ªô chi·∫øu G·ªëc & Visa X2', note: 'V·∫≠t b·∫•t ly th√¢n. Tr√¨nh h·∫£i quan nh·∫≠p c·∫£nh.', tags: ['X√°ch tay', 'Tuy·ªát m·∫≠t'], alert: 'L∆∞u √Ω: ƒêeo t√∫i bao t·ª≠ tr∆∞·ªõc ng·ª±c ƒë·ªÉ gi·ªØ H·ªô chi·∫øu, tuy·ªát ƒë·ªëi kh√¥ng c·∫•t s√¢u v√†o balo.' },
            { id: 'doc2', cat: 'üìÑ Gi·∫•y t·ªù nh·∫≠p h·ªçc', name: 'Th∆∞ tr√∫ng tuy·ªÉn (Giang Nam)', note: 'B·∫£n g·ªëc + 2 b·∫£n photo.', tags: ['X√°ch tay'] },
            { id: 'doc3', cat: 'üìÑ Gi·∫•y t·ªù nh·∫≠p h·ªçc', name: 'Form JW202 / DQ', note: 'Gi·∫•y ph√©p du h·ªçc sinh. Tr√¨nh h·∫£i quan l√∫c nh·∫≠p c·∫£nh.', tags: ['X√°ch tay'] },

            // THU·ªêC MEN & Y T·∫æ
            { id: 'md1', cat: 'üíä T·ªß thu·ªëc mini', name: 'Thu·ªëc h·∫° s·ªët (Panadol Extra)', note: 'Th·ªùi ti·∫øt TQ thay ƒë·ªïi d·ªÖ c·∫£m. C·∫ßn lo·∫°i c√≥ cafein ƒë·ªÉ t·ªânh t√°o.', tags: ['K√Ω g·ª≠i', 'Thu·ªëc'] },
            { id: 'md2', cat: 'üíä T·ªß thu·ªëc mini', name: 'Thu·ªëc ti√™u h√≥a (Berberin / Smecta)', note: 'ƒê·ªì ƒÉn TQ si√™u d·∫ßu m·ª° v√† cay. Ch·∫Øc ch·∫Øn s·∫Ω ƒëau b·ª•ng m·∫•y ng√†y ƒë·∫ßu.', tags: ['K√Ω g·ª≠i', 'Thi·∫øt y·∫øu'] },
            { id: 'md3', cat: 'üíä T·ªß thu·ªëc mini', name: 'BƒÉng c√° nh√¢n (Urgo)', note: 'X·ª≠ l√Ω x√¢y x√°t nh·∫π khi b√™ v√°c h√†nh l√Ω.', tags: ['K√Ω g·ª≠i'] },

            // ƒê·ªí ƒÇN
            { id: 'fd1', cat: 'üçú L∆∞∆°ng th·ª±c c·ª©u ƒë√≥i', name: 'M√¨ g√≥i / Ph·ªü ƒÉn li·ªÅn', note: 'ƒê√≥ng 10 g√≥i. ƒê√™m ƒë·∫ßu ti√™n nh·∫≠n ph√≤ng tr·ªç s·∫Ω kh√¥ng c√≥ ƒë·ªì ƒÉn.', tags: ['K√Ω g·ª≠i'] },
            { id: 'fd2', cat: 'üçú L∆∞∆°ng th·ª±c c·ª©u ƒë√≥i', name: 'Ru·ªëc th·ªãt heo / Kh√¥ g√†', note: 'H√∫t ch√¢n kh√¥ng, b√≥c s·∫°ch nh√£n m√°c th∆∞∆°ng hi·ªáu.', tags: ['K√Ω g·ª≠i HQ'], alert: 'H·∫¢I QUAN: TQ c·∫•m nh·∫≠p c·∫£nh c√°c lo·∫°i th·ªãt c√≥ nh√£n m√°c n∆∞·ªõc ngo√†i. Ph·∫£i h√∫t ch√¢n kh√¥ng th·∫≠t k·ªπ ng·ª•y trang.' },

            // SINH HO·∫†T & M·ª∏ PH·∫®M
            { id: 'lf1', cat: 'üß¥ M·ªπ ph·∫©m & Sinh ho·∫°t', name: 'BƒÉng v·ªá sinh', note: 'N√™n mang 3 b·ªãch to. L√≥t quanh th√†nh vali 28 ƒë·ªÉ ch·ªëng s·ªëc ƒë·ªì v·∫≠t.', tags: ['Vali 28'] },
            { id: 'lf2', cat: 'üß¥ M·ªπ ph·∫©m & Sinh ho·∫°t', name: 'N∆∞·ªõc t·∫©y trang / S·ªØa r·ª≠a m·∫∑t', note: 'Chi·∫øt ra chai nh·ªè <100ml n·∫øu x√°ch tay, ho·∫∑c quƒÉng th·∫≥ng chai to v√†o k√Ω g·ª≠i.', tags: ['Ch·∫•t l·ªèng'], alert: 'H√ÄNG KH√îNG: Ch·∫•t l·ªèng x√°ch tay l√™n m√°y bay kh√¥ng ƒë∆∞·ª£c qu√° 100ml m·ªói chai.' },
            { id: 'lf3', cat: 'üß¥ M·ªπ ph·∫©m & Sinh ho·∫°t', name: 'K√©o c·∫Øt m√≥ng tay, Nh√≠p', note: 'V·∫≠t s·∫Øc nh·ªçn ph·∫£i c·∫•t k√Ω g·ª≠i.', tags: ['K√Ω g·ª≠i HQ'], alert: 'H√ÄNG KH√îNG: C·∫•m x√°ch tay v·∫≠t s·∫Øc nh·ªçn (k√©o, dao lam, nh√≠p s·∫Øt).' }
        ];

        let bag = JSON.parse(localStorage.getItem('packify_v9')) || [];
        let curCat = 'All';

        const App = {
            init() {
                document.getElementById('global-count').innerText = MASTER_DATA.length;
                this.renderSidebar();
                this.renderStore();
            },

            // --- UI CONTROLS ---
            toggleSidebar() {
                document.getElementById('sidebar').classList.toggle('active');
                document.getElementById('overlay').classList.toggle('active');
            },
            switchTab(tab) {
                document.getElementById('view-store').classList.toggle('hidden', tab !== 'store');
                document.getElementById('view-bag').classList.toggle('hidden', tab !== 'bag');
                document.getElementById('tab-store').classList.toggle('active', tab === 'store');
                document.getElementById('tab-bag').classList.toggle('active', tab === 'bag');
                if(tab === 'store') this.renderStore();
                if(tab === 'bag') this.renderBag();
            },
            showToast(msg) {
                const container = document.getElementById('toast-container');
                const toast = document.createElement('div');
                toast.className = 'toast';
                toast.innerHTML = `<span>‚ö†Ô∏è</span> <span>${msg}</span>`;
                container.appendChild(toast);
                setTimeout(() => toast.remove(), 6000); // T·ª± bi·∫øn m·∫•t sau 6s
            },
            getTagsHTML(tags) {
                return tags.map(t => {
                    let cls = t.includes('HQ') || t.includes('Kh·∫©n') ? 'tag-warn' : t.includes('Digi') || t.includes('Code') ? 'tag-digi' : 'tag-safe';
                    return `<span class="tag ${cls}">${t}</span>`;
                }).join('');
            },

            // --- SIDEBAR (LAZADA TREE) ---
            renderSidebar() {
                const list = document.getElementById('cat-list');
                const categories = ['All', ...new Set(MASTER_DATA.map(i => i.cat))];
                
                list.innerHTML = categories.map(cat => {
                    const count = cat === 'All' ? MASTER_DATA.length : MASTER_DATA.filter(i => i.cat === cat).length;
                    return `
                    <div class="cat-item ${curCat === cat ? 'active' : ''}" onclick="App.setCategory('${cat}')">
                        <span>${cat === 'All' ? 'T·∫•t c·∫£ danh m·ª•c' : cat}</span>
                        <span class="cat-count">${count}</span>
                    </div>`;
                }).join('');
            },
            setCategory(cat) {
                curCat = cat;
                this.toggleSidebar();
                this.renderSidebar();
                this.renderStore();
            },

            // --- STORE TAB ---
            renderStore() {
                const container = document.getElementById('view-store');
                const kw = document.getElementById('searchInput').value.toLowerCase();
                container.innerHTML = '';

                const catsToRender = curCat === 'All' ? [...new Set(MASTER_DATA.map(i => i.cat))] : [curCat];
                
                catsToRender.forEach(cat => {
                    const items = MASTER_DATA.filter(i => i.cat === cat && (i.name.toLowerCase().includes(kw) || i.note.toLowerCase().includes(kw)));
                    if(items.length === 0) return;

                    let html = `<div style="font-weight:bold; margin:15px 0 8px; font-size:1.05rem;">${cat}</div>`;
                    items.forEach(item => {
                        const inBag = bag.some(x => x.id === item.id);
                        html += `
                        <div class="card">
                            <div class="card-info">
                                <div class="item-name">${item.name}</div>
                                <div class="item-note">${item.note}</div>
                                <div class="tags">${this.getTagsHTML(item.tags)}</div>
                            </div>
                            <button class="btn btn-add ${inBag ? 'added' : ''}" onclick="App.addStoreItem('${item.id}')">
                                ${inBag ? '‚úì' : '+'}
                            </button>
                        </div>`;
                    });
                    container.innerHTML += html;
                });
            },
            addStoreItem(id) {
                const item = MASTER_DATA.find(i => i.id === id);
                if(!bag.some(x => x.id === id)) {
                    bag.push({...item, done: false});
                    if(item.alert) this.showToast(item.alert);
                } else {
                    bag = bag.filter(x => x.id !== id);
                }
                localStorage.setItem('packify_v9', JSON.stringify(bag));
                this.renderStore();
            },

            // --- BAG TAB ---
            renderBag() {
                const container = document.getElementById('bag-list');
                container.innerHTML = '';

                if(bag.length === 0) {
                    container.innerHTML = '<div style="text-align:center; padding: 40px; color: var(--text-sub);">Vali ƒëang tr·ªëng.</div>';
                    this.updateProgress();
                    return;
                }

                const cats = [...new Set(bag.map(i => i.cat))];
                cats.forEach(cat => {
                    const items = bag.filter(i => i.cat === cat);
                    let html = `<div style="font-weight:bold; margin:15px 0 8px; font-size:1.05rem;">${cat}</div>`;
                    items.forEach(item => {
                        html += `
                        <div class="card ${item.done ? 'done' : ''}">
                            <div class="btn-check" onclick="App.toggleDone('${item.id}')"></div>
                            <div class="card-info" onclick="App.toggleDone('${item.id}')">
                                <div class="item-name">${item.name}</div>
                                <div class="item-note">${item.note}</div>
                                <div class="tags">${this.getTagsHTML(item.tags)}</div>
                            </div>
                            <button class="btn btn-minus" onclick="App.removeBagItem('${item.id}')">-</button>
                        </div>`;
                    });
                    container.innerHTML += html;
                });
                this.updateProgress();
            },
            toggleDone(id) {
                const item = bag.find(i => i.id === id);
                if(item) {
                    item.done = !item.done;
                    if(item.done && item.alert) this.showToast(item.alert);
                    localStorage.setItem('packify_v9', JSON.stringify(bag));
                    this.renderBag();
                }
            },
            removeBagItem(id) {
                bag = bag.filter(x => x.id !== id);
                localStorage.setItem('packify_v9', JSON.stringify(bag));
                this.renderBag();
            },
            updateProgress() {
                const total = bag.length;
                const done = bag.filter(i => i.done).length;
                const pct = total === 0 ? 0 : Math.round((done / total) * 100);
                document.getElementById('prog-text').innerText = `${done}/${total} (${pct}%)`;
                document.getElementById('prog-fill').style.width = `${pct}%`;
            }
        };

        App.init();
    </script>
</body>
</html>
